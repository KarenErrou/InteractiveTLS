
<!--------------- Certificate ------------------>   
<div class="stepServer"> 
	<div class="stepServerContent" id="authentication" ng-if="step<6 && sigalgoClient == true" style="background-color: #E5E7E9;">
        <div  ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleServer" ng-model="step" id="authentication"> 7</div>
        <div  ng-if="keyExchange[0] == 'serverHello'" class="circleServer" ng-model="step" id="authentication"> 5</div>
        <h3>Certificate</h3>
        <p> (This message is encrypted) </p> <br/>
        <div>This message contains the certificate to be used for authentication and any supporting certificate in the chain.   </div><br/>
        <div style="display: inline-block;">
            certificate_list 
            <div class="infoButton" ng-click="showInfo('certificate', {eltName: 'certficate_list', info: '<i>certificate_list</i> is a sequence of certificates that can be either of type X509 or RawPublicKey.  The first certificate must be the sender’s certificate, then each following certificate directly certify the one preceding it.' }, 'info')">i</div>
        </div>  
    </div>

<!-- 
    <span ng-if= "step>6  && sigalgoClient == true" style="font-size:100px; color: #16A085;"> &larr; </span> -->
    <div class="stepServerContent" id="authentication" ng-if= "step>=6 && sigalgoClient == true">
        <div  ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleServer" ng-model="step" id="authentication"> 7</div>
        <div  ng-if="keyExchange[0] == 'serverHello'" class="circleServer" ng-model="step" id="authentication"> 5</div> 
        <h3>Certificate</h3>
        <p> (This message is encrypted) </p> <br/>
        <div>This message contains the certificate to be used for authentication and any supporting certificate in the chain.   </div><br/>
        <div style="display: inline-block;">
            certificate_list 
            <div class="infoButton" ng-click="showInfo('certificate', {eltName: 'certficate_list', info: '<i>certificate_list</i> is a sequence of certificates that can be either of type X509 or RawPublicKey.  The first certificate must be the sender’s certificate, then each following certificate directly certify the one preceding it.' }, 'info')">i</div>
        </div>  
    
        
        </br>  
        <button ng-show='step == 6' ng-click="incrementStep(step,'normal')" id="authenticationButton">
            Next Step
        </button>
    </div>
</div>



<!--------------- Certificate Vertify ------------------>   
<div class="stepServer"> 
    <div class="stepServerContent" id="authentication" ng-if="step<7 && sigalgoClient == true" style="background-color: #E5E7E9;">
        <div ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleServer" ng-model="step" id="authentication"> 8</div>
        <div ng-if="keyExchange[0] == 'serverHello'" class="circleServer" ng-model="step" id="authentication"> 6</div>
        <h3>Certificate Verify</h3>
        <p> (This message is encrypted) </p> <br/>
        <p> The certificateVerify message is used to prove that the endpoint have the private key corresponding to its certificate.</p> 
        <p>Additionally it provides integrityof the handshake until this point </p>
    </div>


    <!-- <span ng-if= "step>7  && sigalgoClient == true" style="font-size:100px; color: #16A085;"> &larr; </span> -->
    <div class="stepServerContent" id="authentication" ng-if= "step>=7 && sigalgoClient == true">
        <div ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleServer" ng-model="step" id="authentication"> 8</div>
        <div ng-if="keyExchange[0] == 'serverHello'" class="circleServer" ng-model="step" id="authentication"> 6</div> 
        <h3>Certificate Verify</h3>
        <p> (This message is encrypted) </p> <br/>
        <p> The certificateVerify message is used to prove that the endpoint have the private key corresponding to its certificate.</p> 
        <p>Additionally it provides integrityof the handshake until this point </p>
       
        <button ng-show='step == 7' ng-click="incrementStep(step,'normal')" id="authenticationButton">
            Next Step
        </button>
    </div>
</div>

<!--------------- Finished ------------------>   
<div class="stepServer"> 
    <div class="stepServerContent" id="authentication" ng-if="step<8" style="background-color: #E5E7E9;">
        <div ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleServer" ng-model="step" id="authentication"> 9</div>
        <div ng-if="keyExchange[0] == 'serverHello'" class="circleServer" ng-model="step" id="authentication"> 7</div>
        <h3>Finished</h3>
        <p> (This message is encrypted) </p> <br/>
        <p>This message is a Message Authentication Code (MAC) over the entire handshake. It provides key confirmation, binds the endpoint’s identity to the exchanged keys, and authenticates the handshake in PSK mode </p>
        
        <p>This message is essential for providing authentication of both the handshake and the computed keys.</p>
    </div>

    <span ng-if= "step>8" style="font-size:100px; color: #16A085;"> &larr; </span>

    <div class="stepServerContent" id="authentication" ng-if= "step>=8">
        <div ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleServer" ng-model="step" id="authentication"> 9</div>
        <div ng-if="keyExchange[0] == 'serverHello'" class="circleServer" ng-model="step" id="authentication"> 7</div>
        <h3>Finished</h3>
        <p> (This message is encrypted) </p> <br/>
        <p>This message is a Message Authentication Code (MAC) over the entire handshake. It provides key confirmation, binds the endpoint’s identity to the exchanged keys, and authenticates the handshake in PSK mode </p>
       
        <p>This message is essential for providing authentication of both the handshake and the computed keys.</p>
        
        <button ng-show='step == 8' ng-click="incrementStep(step,'certS')" id= "authenticationButton">
            Next Step
        </button>
    </div>
</div>

<!----------------------- EARLY DATA ---------------->
<div ng-if="keyExMode == 2 || keyExMode == 3 || keyExMode == 4" class="stepServer">
    <div class="stepServerContent" style="background-color:#2471A3; color: #fff;">
        <h3>Application Data</h3>    
        PSK mode: the client can send earlier application data.    
    </div>
</div>


<!------------------ CLIENT ------------------->

<div class="stepClient"> 
    <div class="stepClientContent" id="authentication" ng-if="step<9 && sigalgoServer == true" style="background-color: #E5E7E9;">
        <div  ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleClient" ng-model="step" id="authentication"> 10</div>
        <div  ng-if="keyExchange[0] == 'serverHello'" class="circleClient" ng-model="step" id="authentication"> 8</div>
        <h3>Certificate</h3>
        <p> (This message is encrypted) </p> <br/>
        <div>This message contains the certificate to be used for authentication and any supporting certificate in the chain.   </div><br/>
        <div style="display: inline-block;">
            <div class="infoButton" ng-click="showInfo('certificate', {eltName: 'certficate_list', info: '<i>certificate_list</i> is a sequence of certificates that can be either of type X509 or RawPublicKey.  The first certificate must be the sender’s certificate, then each following certificate directly certify the one preceding it.' }, 'info')">i</div>
            certificate_list 
        </div>  
    </div>


    <div class="stepClientContent" id="authentication" ng-if= "step>=9 && sigalgoServer == true">
         <div  ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleClient" ng-model="step" id="authentication"> 7</div>
        <div  ng-if="keyExchange[0] == 'serverHello'" class="circleClient" ng-model="step" id="authentication"> 5</div> 
        <h3>Certificate</h3>
        <p> (This message is encrypted) </p> <br/>
        <div>This message contains the certificate to be used for authentication and any supporting certificate in the chain.   </div><br/>
        <div style="display: inline-block;">
            <div class="infoButton" ng-click="showInfo('certificate', {eltName: 'certficate_list', info: '<i>certificate_list</i> is a sequence of certificates that can be either of type X509 or RawPublicKey.  The first certificate must be the sender’s certificate, then each following certificate directly certify the one preceding it.' }, 'info')">i</div>
            certificate_list 
        </div>  
        <br/>
    
        <button ng-show='step == 9' ng-click="incrementStep(step,'normal')" id="authenticationButton">
            Next Step
        </button>
    </div>

    <!-- <span ng-if= "step>9  && sigalgoServer == true" style="font-size:100px; color: #16A085;"> &rarr; </span> -->
</div>



<!--------------- Certificate Vertify ------------------>   
<div class="stepClient"> 
    <div class="stepClientContent" id="authentication" ng-if="step<10 && sigalgoServer == true" style="background-color: #E5E7E9;">
        <div ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleClient" ng-model="step" id="authentication"> 11</div>
        <div ng-if="keyExchange[0] == 'serverHello'" class="circleClient" ng-model="step" id="authentication"> 9</div>
        <h3>Certificate Verify</h3>
        <p> (This message is encrypted) </p> <br/>
        <p> The certificateVerify message is used to prove that the endpoint have the private key corresponding to its certificate.</p> 
        <p>Additionally it provides integrityof the handshake until this point </p>
    </div>


    <div class="stepClientContent" id="authentication" ng-if= "step>=10 && sigalgoServer == true">
        <div ng-if="keyExchange[0] == 'helloRetryRequest'" class="circleClient" ng-model="step" id="authentication"> 11</div>
        <div ng-if="keyExchange[0] == 'serverHello'" class="circleClient" ng-model="step" id="authentication"> 9</div> 
        <h3>Certificate Verify</h3>
        <p> (This message is encrypted) </p> <br/>
        <p> The certificateVerify message is used to prove that the endpoint have the private key corresponding to its certificate.</p> 
        <p>Additionally it provides integrityof the handshake until this point </p>
        
        <button ng-show='step == 10' ng-click="incrementStep(step,'normal')" id="authenticationButton">
            Next Step
        </button>
    </div>
    <!-- <span ng-if= "step>10  && sigalgoServer == true" style="font-size:100px; color: #16A085;"> &rarr; </span> -->
</div>


<!--------------- Finished ------------------>   
<div class="stepClient"> 
    <div class="stepClientContent" id="authentication" ng-if="step<11" style="background-color: #E5E7E9;">
        <div ng-if="keyExchange[0] == 'helloRetryRequest'"  class="circleClient" ng-model="step" id="authentication"> 12</div>
        <div ng-if="keyExchange[0] == 'serverHello'"  class="circleClient" ng-model="step" id="authentication"> 10</div>
        <h3>Finished</h3>
        <h3>Finished</h3>
        <p> (This message is encrypted) </p> <br/>
        <p>This message is a Message Authentication Code (MAC) over the entire handshake. It provides key confirmation, binds the endpoint’s identity to the exchanged keys, and authenticates the handshake in PSK mode </p>
        
        <p>This message is essential for providing authentication of both the handshake and the computed keys.</p>
    </div>


    <div class="stepClientContent" id="authentication" ng-if= "step>=11">
        <div ng-if="keyExchange[0] == 'helloRetryRequest'"  class="circleClient" ng-model="step" id="authentication"> 12</div>
        <div ng-if="keyExchange[0] == 'serverHello'"  class="circleClient" ng-model="step" id="authentication"> 10</div> 
        <h3>Finished</h3>
        <p> (This message is encrypted) </p> <br/>
        <p>This message is a Message Authentication Code (MAC) over the entire handshake. It provides key confirmation, binds the endpoint’s identity to the exchanged keys, and authenticates the handshake in PSK mode </p>
        
        <p>This message is essential for providing authentication of both the handshake and the computed keys.</p>
         <button ng-show='step == 11' ng-click="incrementStep(step,'normal')" id="authenticationButton">
            Next Step
        </button>
    </div>

    <span ng-if= "step>=12" style="font-size:100px; color: #16A085;"> &rarr; </span>
</div>

<div>
    <div ng-if= "step>=12" class="stepClient">
        <div  class="stepClientContent" style="background-color:#2471A3; color: #fff;">
            <h3>Application Data</h3>    
        </div>
        <span style="font-size:100px; color: #2471A3;"> &rarr; </span>
    </div>
</div>
</div>
    <div ng-if= "step>=12" class="stepServer">

        <span style="font-size:100px; color: #2471A3;"> &larr; </span>
        <div  class="stepServerContent" style="background-color:#2471A3; color: #fff;">
            <h3>Application Data</h3>    
        </div>
    </div>
</div>